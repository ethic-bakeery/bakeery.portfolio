---
title: "Traffic Analysis"
description: "This guide demonstrates how to analyze malware traffic using Wireshark, specifically focusing on identifying exploitation attempts and understanding TCP traffic patterns."
pubDate: 2023-01-21
category: "Wireshark"
draft: false
---

#### **Question 1: What is the destination IP address that received the request with the payload `=${jndi:ldap://`?**

To address this question, I initially considered searching for the exact string in the TCP traffic using a `contains` filter. However, I encountered an error when trying to search for the full string `“=${jndi:ldap://?”`, as shown in the image below:

![Error Encountered](/letsdefend/malware/error.webp)

Given this issue, I refined my approach and instead searched for the substring `jndi`, which revealed the destination IP address. The destination address is shown in the image below:

![Destination IP](/letsdefend/malware/q1-2.webp)

#### **Answer:**
The destination IP address is:  
**198.71.247.91**

---

#### **Question 2: In what year was the HTTP request sent in the question above?**

From the image above, we can see the date when the HTTP request was sent.

#### **Answer:**
The year is:  
**2021**

---

#### **Question 3: How many packets with destination port 80 are among all TCP packets?**

To answer this question, we can filter the TCP traffic for packets with destination port 80 (HTTP) `tcp.dstport==80`, as shown in the image below:

![Dest Packets](/letsdefend/malware/q3.webp)

#### **Answer:**
The number of packets with destination port 80 is:  
**9410**

---

#### **Question 4: How many packets were exchanged between "198.71.247.91" and "91.189.89.199"?**

To answer this question, we filter for the traffic between the two specific IP addresses using an `ip.addr==198.71.247.91 && ip.addr==91.189.89.199` filter, as shown in the image below:

![Exchange Packets](/letsdefend/malware/q4.webp)

#### **Answer:**
The number of packets exchanged between the two IP addresses is:  
**424**

---

#### **Question 5: How many IP addresses are there trying to exploit the Log4j vulnerability by connecting to the address “31.131.16.127” according to the log records?**

To find the answer, we can filter the TCP traffic and search for connections involving the IP address `31.131.16.127`. The search query is `tcp contains 31.131.16.127` The result is shown in the image below:

![IP Addresses](/letsdefend/malware/q5-t2-best.webp)

#### **Answer:**
The number of IP addresses attempting to exploit the vulnerability is:  
**2**

---

#### **Conclusion**

By utilizing Wireshark’s powerful filtering capabilities, we can effectively track malicious traffic and identify exploit attempts, such as those targeting the Log4j vulnerability. This challenge demonstrates how to analyze and extract key insights from captured malware traffic.
